<!DOCTYPE html><html lang="en"><head><title>components/gauge</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="components/gauge"><meta name="groc-project-path" content="src/components/gauge.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/components/gauge.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="jauge">Jauge</h1></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Réutilisé absolument partout dans l’application…  Un parfait
exemple de composant réutilisable, du coup !</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>On prend soin de n’importer que les quelques couleurs qui nous intéressent (le module
en contient des centaines) pour favoriser le <em>tree shaking</em> en mode production.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">import</span> { amber500, green500, orange500, red500 } <span class="hljs-keyword">from</span> <span class="hljs-string">'material-ui/styles/colors'</span>
<span class="hljs-keyword">import</span> React, { PropTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">import</span> LinearProgress <span class="hljs-keyword">from</span> <span class="hljs-string">'material-ui/LinearProgress'</span>

<span class="hljs-keyword">import</span> { getCompletionRatio } <span class="hljs-keyword">from</span> <span class="hljs-string">'../lib/helpers'</span>

const Gauge = ({ value, max = 100 }) =&gt; (
  &lt;LinearProgress
    mode=<span class="hljs-string">'determinate'</span>
    value={value}
    max={max}
    style={{ height: 8 }}
    color={gaugeColor(value, max)}
  /&gt;
)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Comme toujours, on définit les propriétés attendues/autorisées pour validation.</p></div></div><div class="code"><div class="wrapper">Gauge.propTypes = {
  value: PropTypes.number.isRequired,
  max: PropTypes.number
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>C’est ici qu’on calcule la couleur de la jauge d’après le rapport entre son
propre taux d’achèvement et le moment de la journée.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gaugeColor</span> (<span class="hljs-params">current, target</span>) </span>{
  <span class="hljs-keyword">const</span> ratio = getCompletionRatio(current, target)

  <span class="hljs-keyword">if</span> (ratio &lt; <span class="hljs-number">0.5</span>) {
    <span class="hljs-keyword">return</span> red500
  }
  <span class="hljs-keyword">if</span> (ratio &lt; <span class="hljs-number">0.75</span>) {
    <span class="hljs-keyword">return</span> orange500
  }
  <span class="hljs-keyword">return</span> ratio &lt; <span class="hljs-number">0.9</span> ? amber500 : green500
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Gauge</div></div></div></div></body></html>